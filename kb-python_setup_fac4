##Start galaxy container on fac04 then activate conda env

cd /cvmfs/soft.galaxy/v2.1/tool-dependency/_conda/

source bin/activate

##Create kb python envi

conda create  --prefix /cvmfs/soft.galaxy/v2.1/tool-dependency/_conda/envs/__kb-python@0.24.4

conda activate /cvmfs/soft.galaxy/v2.1/tool-dependency/_conda/envs/__kb-python@0.24.4

#install pip and kb-python

conda install -c anaconda pip

pip install kb-python==0.24.4


# Create Index References in to =

cd /cvmfs/soft.galaxy/v2.1/server/tools/single_cell_tools/refs/kb_python/Index/Mouse

# This downloads a pre-built index for kallisto to use when pseudoaligning the reads
kb ref -d mouse -i index.idx -g t2g.txt

#This is the normal way of building an index
#kb ref -i transcriptome.idx -g transcripts_to_genes.txt -f1 cdna.fa

##RUn kb count on test dataset from tutorial https://github.com/pachterlab/kallistobustools/blob/master/notebooks/kb_intro_2_python.ipynb

curl https://caltech.box.com/shared/static/w9ww8et5o029s2e3usjzpbq8lpot29rh.gz --output SRR8599150_S1_L001_R1_001.fastq.gz
curl https://caltech.box.com/shared/static/ql00zyvqnpy7bf8ogdoe9zfy907guzy9.gz --output SRR8599150_S1_L001_R2_001.fastq.gz






